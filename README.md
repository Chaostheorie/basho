[![Python Version](https://img.shields.io/badge/python-3.8.3-blue?style=for-the-badge&logo=python)](https://www.python.org/downloads/release/python-383/) [![Quart Version](https://img.shields.io/badge/Quart-0.13.0-red?style=for-the-badge)](https://gitlab.com/pgjones/quart) [![Gino Version](https://img.shields.io/badge/Gino-1.1.0b1-blue?style=for-the-badge)](https://python-gino.org/) ![code style](https://img.shields.io/badge/code%20style-black-black?style=for-the-badge)

<hr>

# Basho :house:

Basho (jap. room) is a quart application for room management with a user system and responsive material-style frontend. Successor of basho with quart as base.

## Installation

> This is not yet production ready

A working instance of [`pip`](https://packaging.python.org/tutorials/installing-packages/#installing-packages) and [python 3.8](https://www.python.org/downloads/release/python-382/) is required.

Install all dependencies:

`pip3 install -r requirements.txt`

Setup `.env` file (may vary for [windows](http://www.dowdandassociates.com/blog/content/howto-set-an-environment-variable-in-windows-command-line-and-registry/)) (Read by [dotenv](https://pypi.org/project/python-dotenv/)). Replace `{}` with your own credentials. `SECRET` should be e.g. a random generated string. `SECRET` is used as key for cookie encryption. See [Security](#Security) for more info.

```environment
DATABASE-USER={}
DATABASE={}
ADDRESS={}
PASSWORD={}
DEBUG={true is recommended}
DRIVER=postgres
SECRET={}
```

To use alembic for migrations you may need to change you `PYTHONPATH` according to [Gino and alembic](https://python-gino.org/docs/en/master/how-to/alembic.html#create-first-migration-revision). When using alembic you may need to change the auto generated files, if e.g. tables are deleted in an inappropriate order.

To apply the migrations you need to run `alembic upgrade head`.

Now your ready to run `python3 toolkit.py devserver` for a local [uvicorn](https://www.uvicorn.org/) development server. Run `python3 toolkit.py devserver --help` for further help and options.

The `toolkit.py` will also contain database utilities in the future.

## Development Notes

[Black](https://github.com/ambv/black) is used as code style. Consider using a black integration in your IDE.

## Security

The authentication is done via tokens stored in encrypted cookies. These cookies are generated by taking advantage of [secure](https://pypi.org/project/secure/0.1.8/) and the user stores the hashed token either for 30 days or the session.

The hashing step is to secure the token against a loss of the secret key, which would led to the cookie being compromised. Instead even if the cookie encryption is compromised only a hash and the username is retrieved. This combo leeds to a moderate level of security.

> The security key should still be kept _secret_. Change it to something secure (python 3s `secrets.token_urlsafe`) and put it in your environment. _Don't hardcode it into the application_

## Attributions

- [Material Icons](https://material.io/resources/icons/) with [Apache License version 2.0](https://www.apache.org/licenses/LICENSE-2.0.html)
- [Materialize.css](https://materializecss.com/) with [MIT License @ Materialize](https://github.com/Dogfalo/materialize/blob/master/LICENSE)
- All libraries mentioned in `requirements.txt`

## License

[MIT License by Cobalt](https://github.com/Chaostheorie/basho-reloaded/blob/master/LICENSE)

```text
MIT License

Copyright (c) 2020 Cobalt

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

## Disclaimer

This application has no affiliation with [Basho Technologies](https://github.com/basho) and its name is based on the japanese word basho ~ room.
